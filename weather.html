<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
  <title>Weather - Worrigee, NSW | Hackers Cup</title>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>
  
  <!-- Tailwind Config -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
          },
          colors: {
            hackers: {
              dark: '#0f172a',
              navy: '#1e3a5f',
              sky: '#0ea5e9',
              light: '#38bdf8',
              gold: '#f59e0b',
              surface: '#1e293b',
            }
          },
          animation: {
            'fade-in': 'fadeIn 0.5s ease-in-out',
            'slide-up': 'slideUp 0.6s ease-out',
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'float': 'float 3s ease-in-out infinite',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' },
            },
            slideUp: {
              '0%': { transform: 'translateY(20px)', opacity: '0' },
              '100%': { transform: 'translateY(0)', opacity: '1' },
            },
            float: {
              '0%, 100%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-10px)' },
            }
          }
        }
      }
    }
  </script>
  
  <style>
    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    ::-webkit-scrollbar-track {
      background: #0f172a;
    }
    ::-webkit-scrollbar-thumb {
      background: #334155;
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #475569;
    }
    
    /* Glassmorphism Utilities */
    .glass {
      background: rgba(30, 41, 59, 0.7);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .glass-card {
      background: rgba(30, 41, 59, 0.6);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      transition: all 0.3s ease;
    }
    
    .glass-card:hover {
      background: rgba(30, 41, 59, 0.8);
      border-color: rgba(14, 165, 233, 0.3);
      transform: translateY(-4px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
    }
    
    /* Bottom Nav */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(20px);
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      z-index: 50;
      padding-bottom: env(safe-area-inset-bottom);
    }
    
    /* Hero Gradient */
    .hero-gradient {
      background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 50%, #0f172a 100%);
    }
    
    /* Loading Spinner */
    .loader {
      border: 3px solid rgba(255, 255, 255, 0.1);
      border-top-color: #38bdf8;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Weather specific styles */
    .weather-icon-large {
      font-size: 80px;
      line-height: 1;
      filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.4));
    }

    .temp-display {
      font-size: 3.5rem;
      font-weight: 800;
      line-height: 1;
      background: linear-gradient(135deg, #38bdf8 0%, #0ea5e9 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    @media (min-width: 768px) {
      .temp-display {
        font-size: 4.5rem;
      }
      .weather-icon-large {
        font-size: 100px;
      }
    }

    .forecast-day {
      transition: all 0.3s ease;
    }

    .forecast-day:hover {
      transform: translateY(-8px);
    }

    /* Weather background effects */
    .weather-bg {
      position: relative;
      overflow: hidden;
    }

    .weather-bg::before {
      content: '';
      position: absolute;
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, rgba(14, 165, 233, 0.15) 0%, transparent 70%);
      top: -250px;
      right: -250px;
      animation: pulse-slow 4s infinite;
    }
  </style>
  <link rel="manifest" href="site.webmanifest">
</head>
<body class="bg-hackers-dark text-white font-sans antialiased pb-24">
  
  <!-- Preloader -->
  <div id="preloader" class="fixed inset-0 z-[100] bg-hackers-dark flex items-center justify-center transition-opacity duration-500">
    <div class="text-center">
      <div class="loader mx-auto mb-4"></div>
      <p class="text-gray-400 text-sm tracking-wider uppercase">Loading Weather...</p>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="fixed top-0 w-full z-40 glass border-b border-white/10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <!-- Logo -->
        <div class="flex-shrink-0 flex items-center gap-3">
          <div class="w-10 h-10 rounded-full flex items-center justify-center overflow-hidden bg-hackers-navy">
            <img src="assets/images/logo.png" alt="Hackers Cup Logo" class="w-8 h-8 object-contain">
          </div>
          <span class="font-bold text-xl tracking-tight">Hackers Cup</span>
        </div>
        
        <!-- Desktop Menu -->
        <div class="hidden md:flex items-center space-x-1">
          <a href="index.html" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors">Home</a>
          <a href="register.html" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors">Register</a>
          <a href="venue.html" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors">Venue</a>
          <a href="payment.html" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors">Payment</a>
          <a href="podcast.html" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors">Podcast</a>
          <a href="schedule.html" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors">Schedule</a>
          <a href="weather.html" class="px-4 py-2 rounded-lg text-sm font-medium text-white bg-white/10 hover:bg-white/20 transition-colors">Weather</a>
          <a href="score.html" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors">Score</a>
          <a href="honour-roll.html" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors">Honour Roll</a>
          <a href="notifications-center.html" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors">Notifications</a>
        </div>
        
        <!-- Mobile Menu Button -->
        <div class="md:hidden">
          <button onclick="toggleMobileMenu()" class="p-2 rounded-lg text-gray-300 hover:text-white hover:bg-white/10">
            <i data-lucide="menu" class="w-6 h-6"></i>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden glass border-t border-white/10">
      <div class="px-4 pt-2 pb-3 space-y-1">
        <a href="index.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10">Home</a>
        <a href="register.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10">Register</a>
        <a href="venue.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10">Venue</a>
        <a href="payment.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10">Payment</a>
        <a href="podcast.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10">Podcast</a>
        <a href="schedule.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10">Schedule</a>
        <a href="weather.html" class="block px-3 py-2 rounded-md text-base font-medium text-white bg-hackers-sky/30">Weather</a>
        <a href="score.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10">Score</a>
        <a href="honour-roll.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10">Honour Roll</a>
        <a href="notifications-center.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10">Notifications</a>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="pt-20 px-4 pb-8 max-w-7xl mx-auto">
    
    <!-- Header -->
    <div class="text-center mb-8 animate-fade-in">
      <div class="flex items-center justify-center gap-3 mb-3">
        <i data-lucide="cloud-sun" class="w-8 h-8 text-hackers-sky"></i>
        <h1 class="text-3xl md:text-4xl font-bold">Weather Forecast</h1>
      </div>
      <p class="text-gray-400">Worrigee, NSW, Australia</p>
      <p id="last-updated" class="text-sm text-gray-500 mt-2"></p>
    </div>

    <!-- Current Weather Section -->
    <div class="mb-8 animate-slide-up">
      <div class="glass-card rounded-3xl p-6 md:p-8 weather-bg">
        <div class="relative z-10">
          <div class="text-center mb-4">
            <h2 class="text-xl md:text-2xl font-semibold text-gray-300">Current Weather</h2>
          </div>
          
          <div id="current-weather" class="flex flex-col items-center">
            <!-- Loading state -->
            <div class="loader mx-auto"></div>
          </div>

          <!-- Additional Current Weather Details -->
          <div id="current-details" class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4">
            <!-- Details will be populated here -->
          </div>
        </div>
      </div>
    </div>

    <!-- 7-Day Forecast Section -->
    <div class="mb-8">
      <h2 class="text-xl md:text-2xl font-bold mb-4 md:mb-6 flex items-center gap-2">
        <i data-lucide="calendar-days" class="w-6 h-6 text-hackers-sky"></i>
        7-Day Forecast
      </h2>
      <div id="forecast" class="flex flex-col md:grid md:grid-cols-3 lg:grid-cols-7 gap-3 md:gap-4">
        <!-- Forecast cards will be inserted here -->
      </div>
    </div>

    <!-- Sun & Moon Information -->
    <div class="mb-8">
      <h2 class="text-xl md:text-2xl font-bold mb-4 md:mb-6 flex items-center gap-2">
        <i data-lucide="sunrise" class="w-6 h-6 text-hackers-gold"></i>
        Sun & Moon
      </h2>
      <div class="grid md:grid-cols-2 gap-4">
        <div class="glass-card rounded-2xl p-6">
          <div class="flex items-center justify-between mb-4">
            <h3 class="font-semibold text-gray-300">Sunrise & Sunset</h3>
            <i data-lucide="sun" class="w-5 h-5 text-hackers-gold"></i>
          </div>
          <div class="space-y-3">
            <div class="flex justify-between items-center">
              <div class="flex items-center gap-2">
                <i data-lucide="sunrise" class="w-4 h-4 text-orange-400"></i>
                <span class="text-gray-400">Sunrise</span>
              </div>
              <span id="sunrise" class="text-white font-semibold">--:--</span>
            </div>
            <div class="flex justify-between items-center">
              <div class="flex items-center gap-2">
                <i data-lucide="sunset" class="w-4 h-4 text-orange-600"></i>
                <span class="text-gray-400">Sunset</span>
              </div>
              <span id="sunset" class="text-white font-semibold">--:--</span>
            </div>
            <div class="flex justify-between items-center pt-2 border-t border-white/10">
              <span class="text-gray-400">Daylight</span>
              <span id="daylight" class="text-white font-semibold">-- hrs</span>
            </div>
          </div>
        </div>

        <div class="glass-card rounded-2xl p-6">
          <div class="flex items-center justify-between mb-4">
            <h3 class="font-semibold text-gray-300">UV Index</h3>
            <i data-lucide="sun" class="w-5 h-5 text-yellow-400"></i>
          </div>
          <div class="text-center py-2">
            <div id="uv-index" class="text-4xl font-bold text-white mb-2">--</div>
            <div id="uv-level" class="text-sm text-gray-400 mb-3">Calculating...</div>
            <div id="uv-progress" class="w-full h-2 bg-gray-700 rounded-full overflow-hidden">
              <div id="uv-bar" class="h-full bg-gradient-to-r from-green-500 to-red-500 transition-all duration-500" style="width: 0%"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Rain Radar -->
    <div class="mb-8">
      <h2 class="text-xl md:text-2xl font-bold mb-4 md:mb-6 flex items-center gap-2">
        <i data-lucide="radar" class="w-6 h-6 text-hackers-sky"></i>
        Rain Radar
      </h2>
      <div class="glass-card rounded-3xl p-4 md:p-6">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4">
          <div>
            <h3 class="text-lg font-semibold text-white">Live Radar</h3>
            <p class="text-sm text-gray-400">Zoom and pan for local showers around Worrigee.</p>
          </div>
          <a href="https://www.rainviewer.com/map.html?loc=-34.878,150.744,9" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 text-sm font-semibold text-hackers-sky">
            Open full map
            <i data-lucide="arrow-up-right" class="w-4 h-4"></i>
          </a>
        </div>
        <div class="rounded-2xl overflow-hidden border border-white/10 bg-black/20">
          <iframe
            title="RainViewer Radar"
            src="https://www.rainviewer.com/map.html?loc=-34.878,150.744,9&layer=radar&sm=1&sn=1"
            class="w-full h-[360px] md:h-[420px]"
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
          ></iframe>
        </div>
      </div>
    </div>

    <!-- Additional Weather Information -->
    <div class="mb-8">
      <h2 class="text-xl md:text-2xl font-bold mb-4 md:mb-6 flex items-center gap-2">
        <i data-lucide="info" class="w-6 h-6 text-hackers-sky"></i>
        More Details
      </h2>
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4">
        <div class="glass-card rounded-2xl p-4 md:p-5">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-8 h-8 rounded-lg bg-cyan-500/20 flex items-center justify-center">
              <i data-lucide="thermometer" class="w-4 h-4 text-cyan-400"></i>
            </div>
            <h3 class="font-medium text-sm text-gray-300">Feels Like</h3>
          </div>
          <p id="feels-like" class="text-2xl md:text-3xl font-bold text-white">--°</p>
        </div>

        <div class="glass-card rounded-2xl p-4 md:p-5">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center">
              <i data-lucide="droplets" class="w-4 h-4 text-blue-400"></i>
            </div>
            <h3 class="font-medium text-sm text-gray-300">Humidity</h3>
          </div>
          <p id="humidity" class="text-2xl md:text-3xl font-bold text-white">--</p>
          <p class="text-xs text-gray-400 mt-1">%</p>
        </div>

        <div class="glass-card rounded-2xl p-4 md:p-5">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-8 h-8 rounded-lg bg-hackers-sky/20 flex items-center justify-center">
              <i data-lucide="wind" class="w-4 h-4 text-hackers-sky"></i>
            </div>
            <h3 class="font-medium text-sm text-gray-300">Wind Speed</h3>
          </div>
          <p id="wind-speed" class="text-2xl md:text-3xl font-bold text-white">--</p>
          <p class="text-xs text-gray-400 mt-1">km/h</p>
        </div>

        <div class="glass-card rounded-2xl p-4 md:p-5">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center">
              <i data-lucide="navigation" class="w-4 h-4 text-purple-400"></i>
            </div>
            <h3 class="font-medium text-sm text-gray-300">Wind Direction</h3>
          </div>
          <p id="wind-direction" class="text-2xl md:text-3xl font-bold text-white">--</p>
        </div>

        <div class="glass-card rounded-2xl p-4 md:p-5">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-8 h-8 rounded-lg bg-orange-500/20 flex items-center justify-center">
              <i data-lucide="cloud-rain" class="w-4 h-4 text-orange-400"></i>
            </div>
            <h3 class="font-medium text-sm text-gray-300">Precipitation</h3>
          </div>
          <p id="precipitation" class="text-2xl md:text-3xl font-bold text-white">--</p>
          <p class="text-xs text-gray-400 mt-1">mm</p>
        </div>

        <div class="glass-card rounded-2xl p-4 md:p-5">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-8 h-8 rounded-lg bg-indigo-500/20 flex items-center justify-center">
              <i data-lucide="gauge" class="w-4 h-4 text-indigo-400"></i>
            </div>
            <h3 class="font-medium text-sm text-gray-300">Pressure</h3>
          </div>
          <p id="pressure" class="text-2xl md:text-3xl font-bold text-white">--</p>
          <p class="text-xs text-gray-400 mt-1">hPa</p>
        </div>

        <div class="glass-card rounded-2xl p-4 md:p-5">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-8 h-8 rounded-lg bg-teal-500/20 flex items-center justify-center">
              <i data-lucide="eye" class="w-4 h-4 text-teal-400"></i>
            </div>
            <h3 class="font-medium text-sm text-gray-300">Visibility</h3>
          </div>
          <p id="visibility" class="text-2xl md:text-3xl font-bold text-white">--</p>
          <p class="text-xs text-gray-400 mt-1">km</p>
        </div>

        <div class="glass-card rounded-2xl p-4 md:p-5">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-8 h-8 rounded-lg bg-pink-500/20 flex items-center justify-center">
              <i data-lucide="cloud" class="w-4 h-4 text-pink-400"></i>
            </div>
            <h3 class="font-medium text-sm text-gray-300">Cloud Cover</h3>
          </div>
          <p id="cloud-cover" class="text-2xl md:text-3xl font-bold text-white">--</p>
          <p class="text-xs text-gray-400 mt-1">%</p>
        </div>
      </div>
    </div>

  </main>

  <!-- Bottom Mobile Navigation -->
  <div class="bottom-nav md:hidden">
    <div class="flex justify-around items-center h-16 pb-safe">
      <a href="index.html" class="flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-white">
        <i data-lucide="home" class="w-6 h-6 mb-1"></i>
        <span class="text-[10px] font-medium">Home</span>
      </a>
      <a href="payment.html" class="flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-white">
        <i data-lucide="credit-card" class="w-6 h-6 mb-1"></i>
        <span class="text-[10px] font-medium">Payment</span>
      </a>
      <a href="podcast.html" class="flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-white">
        <i data-lucide="mic" class="w-6 h-6 mb-1"></i>
        <span class="text-[10px] font-medium">Podcast</span>
      </a>
      <a href="weather.html" class="flex flex-col items-center justify-center w-full h-full text-hackers-sky">
        <i data-lucide="cloud-sun" class="w-6 h-6 mb-1"></i>
        <span class="text-[10px] font-medium">Weather</span>
      </a>
    </div>
  </div>

  <script>
    // Initialize Lucide icons
    lucide.createIcons();
    
    // Hide preloader
    window.addEventListener('load', () => {
      setTimeout(() => {
        const preloader = document.getElementById('preloader');
        if (preloader) {
          preloader.style.opacity = '0';
          setTimeout(() => {
            preloader.style.display = 'none';
          }, 500);
        }
      }, 500);
    });
    
    // Mobile menu toggle
    function toggleMobileMenu() {
      const menu = document.getElementById('mobile-menu');
      menu.classList.toggle('hidden');
    }

    // Weather Icons mapping based on WMO Weather codes
    function getWeatherIcon(weatherCode, isDay = true) {
      const weatherIcons = {
        0: 'sun',           // Clear sky
        1: 'cloud-sun',     // Mainly clear
        2: 'cloud',         // Partly cloudy
        3: 'cloud',         // Overcast
        45: 'cloud-fog',    // Fog
        48: 'cloud-fog',    // Depositing rime fog
        51: 'cloud-drizzle', // Light drizzle
        53: 'cloud-drizzle', // Moderate drizzle
        55: 'cloud-drizzle', // Dense drizzle
        61: 'cloud-rain',   // Slight rain
        63: 'cloud-rain',   // Moderate rain
        65: 'cloud-rain',   // Heavy rain
        71: 'cloud-snow',   // Slight snow
        73: 'cloud-snow',   // Moderate snow
        75: 'cloud-snow',   // Heavy snow
        77: 'snowflake',    // Snow grains
        80: 'cloud-rain',   // Slight rain showers
        81: 'cloud-rain',   // Moderate rain showers
        82: 'cloud-rain',   // Violent rain showers
        85: 'cloud-snow',   // Slight snow showers
        86: 'cloud-snow',   // Heavy snow showers
        95: 'cloud-lightning', // Thunderstorm
        96: 'cloud-lightning', // Thunderstorm with slight hail
        99: 'cloud-lightning', // Thunderstorm with heavy hail
      };
      
      return weatherIcons[weatherCode] || 'cloud';
    }

    function getWeatherDescription(weatherCode) {
      const descriptions = {
        0: 'Clear Sky',
        1: 'Mainly Clear',
        2: 'Partly Cloudy',
        3: 'Overcast',
        45: 'Foggy',
        48: 'Foggy',
        51: 'Light Drizzle',
        53: 'Drizzle',
        55: 'Heavy Drizzle',
        61: 'Light Rain',
        63: 'Rain',
        65: 'Heavy Rain',
        71: 'Light Snow',
        73: 'Snow',
        75: 'Heavy Snow',
        77: 'Snow Grains',
        80: 'Light Showers',
        81: 'Showers',
        82: 'Heavy Showers',
        85: 'Snow Showers',
        86: 'Heavy Snow Showers',
        95: 'Thunderstorm',
        96: 'Thunderstorm with Hail',
        99: 'Severe Thunderstorm',
      };
      
      return descriptions[weatherCode] || 'Unknown';
    }

    // Fetch weather data from Open-Meteo API
    async function fetchWeather() {
      try {
        // Coordinates for Worrigee, NSW
        const lat = -34.878;
        const lon = 150.744;
        
        const response = await fetch(
          `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,surface_pressure,wind_speed_10m,wind_direction_10m,cloud_cover,visibility,uv_index&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum,precipitation_probability_max,sunrise,sunset,uv_index_max,wind_speed_10m_max,wind_direction_10m_dominant&timezone=Australia/Sydney`
        );
        
        if (!response.ok) {
          throw new Error('Weather data fetch failed');
        }
        
        const data = await response.json();
        displayCurrentWeather(data.current, data.current_units);
        displayForecast(data.daily, data.daily_units);
        
        // Update last updated time
        const now = new Date();
        document.getElementById('last-updated').textContent = 
          `Last updated: ${now.toLocaleTimeString('en-AU', { hour: '2-digit', minute: '2-digit' })}`;
        
      } catch (error) {
        console.error('Error fetching weather:', error);
        document.getElementById('current-weather').innerHTML = `
          <div class="text-center text-red-400">
            <i data-lucide="alert-circle" class="w-12 h-12 mx-auto mb-2"></i>
            <p>Unable to load weather data</p>
          </div>
        `;
        lucide.createIcons();
      }
    }

    function displayCurrentWeather(current, units) {
      const iconName = getWeatherIcon(current.weather_code, true);
      const description = getWeatherDescription(current.weather_code);
      
      document.getElementById('current-weather').innerHTML = `
        <div class="flex flex-col md:flex-row items-center justify-center gap-6 md:gap-8">
          <div class="animate-float">
            <i data-lucide="${iconName}" class="weather-icon-large text-hackers-light"></i>
          </div>
          <div class="flex items-center gap-4">
            <div class="temp-display">${Math.round(current.temperature_2m)}°</div>
            <div class="text-left">
              <p class="text-lg md:text-xl text-gray-300">${description}</p>
              <p class="text-sm text-gray-400">Updated just now</p>
            </div>
          </div>
        </div>
      `;
      
      // Update detail cards
      document.getElementById('feels-like').textContent = `${Math.round(current.apparent_temperature)}°`;
      document.getElementById('wind-speed').textContent = Math.round(current.wind_speed_10m);
      document.getElementById('wind-direction').textContent = getWindDirection(current.wind_direction_10m);
      document.getElementById('humidity').textContent = current.relative_humidity_2m;
      document.getElementById('pressure').textContent = Math.round(current.surface_pressure);
      document.getElementById('precipitation').textContent = current.precipitation.toFixed(1);
      document.getElementById('visibility').textContent = (current.visibility / 1000).toFixed(1);
      document.getElementById('cloud-cover').textContent = current.cloud_cover;
      
      // Update UV Index
      const uvIndex = current.uv_index || 0;
      document.getElementById('uv-index').textContent = uvIndex.toFixed(1);
      document.getElementById('uv-level').textContent = getUVLevel(uvIndex);
      document.getElementById('uv-bar').style.width = `${Math.min(uvIndex / 11 * 100, 100)}%`;
      
      lucide.createIcons();
    }

    function getWindDirection(degrees) {
      const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];
      const index = Math.round(degrees / 22.5) % 16;
      return directions[index];
    }

    function getUVLevel(uv) {
      if (uv < 3) return 'Low';
      if (uv < 6) return 'Moderate';
      if (uv < 8) return 'High';
      if (uv < 11) return 'Very High';
      return 'Extreme';
    }

    function displayForecast(daily, units) {
      const forecastContainer = document.getElementById('forecast');
      const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      
      let forecastHTML = '';
      
      for (let i = 0; i < 7; i++) {
        const date = new Date(daily.time[i]);
        const dayName = days[date.getDay()];
        const dateStr = `${date.getDate()} ${months[date.getMonth()]}`;
        const iconName = getWeatherIcon(daily.weather_code[i]);
        const maxTemp = Math.round(daily.temperature_2m_max[i]);
        const minTemp = Math.round(daily.temperature_2m_min[i]);
        const rainChance = daily.precipitation_probability_max[i];
        const precipitation = daily.precipitation_sum[i];
        const windSpeed = daily.wind_speed_10m_max[i];
        const windDir = getWindDirection(daily.wind_direction_10m_dominant[i]);
        const uvIndex = daily.uv_index_max[i];
        
        forecastHTML += `
          <div class="forecast-day glass-card rounded-2xl p-4">
            <div class="flex md:flex-col items-center md:items-center gap-4 md:gap-0">
              <!-- Day Info -->
              <div class="flex-shrink-0 md:w-full md:text-center md:mb-3">
                <p class="font-bold text-white text-lg">${dayName}</p>
                <p class="text-xs text-gray-400">${dateStr}</p>
              </div>
              
              <!-- Icon -->
              <div class="flex-shrink-0 md:mb-3">
                <i data-lucide="${iconName}" class="w-12 h-12 md:w-14 md:h-14 text-hackers-light"></i>
              </div>
              
              <!-- Temperature -->
              <div class="flex-1 md:w-full md:text-center md:mb-3">
                <div class="flex items-baseline justify-start md:justify-center gap-2">
                  <span class="text-2xl md:text-3xl font-bold text-white">${maxTemp}°</span>
                  <span class="text-lg md:text-xl text-gray-400">${minTemp}°</span>
                </div>
              </div>
              
              <!-- Details -->
              <div class="flex-shrink-0 md:w-full space-y-1">
                ${rainChance > 0 ? `
                  <div class="flex items-center ${i > 0 ? 'justify-end md:justify-center' : 'justify-center'} gap-1.5 text-xs text-blue-400">
                    <i data-lucide="droplets" class="w-3.5 h-3.5"></i>
                    <span>${rainChance}%</span>
                    ${precipitation > 0 ? `<span class="text-gray-500">•</span><span>${precipitation.toFixed(1)}mm</span>` : ''}
                  </div>
                ` : ''}
                ${windSpeed ? `
                  <div class="flex items-center ${i > 0 ? 'justify-end md:justify-center' : 'justify-center'} gap-1.5 text-xs text-gray-400">
                    <i data-lucide="wind" class="w-3.5 h-3.5"></i>
                    <span>${Math.round(windSpeed)} km/h ${windDir}</span>
                  </div>
                ` : ''}
                ${uvIndex > 0 ? `
                  <div class="flex items-center ${i > 0 ? 'justify-end md:justify-center' : 'justify-center'} gap-1.5 text-xs text-yellow-400">
                    <i data-lucide="sun" class="w-3.5 h-3.5"></i>
                    <span>UV ${uvIndex.toFixed(0)}</span>
                  </div>
                ` : ''}
              </div>
            </div>
          </div>
        `;
      }
      
      forecastContainer.innerHTML = forecastHTML;
      
      // Update sunrise/sunset for today
      if (daily.sunrise && daily.sunset) {
        const sunrise = new Date(daily.sunrise[0]);
        const sunset = new Date(daily.sunset[0]);
        document.getElementById('sunrise').textContent = sunrise.toLocaleTimeString('en-AU', { hour: '2-digit', minute: '2-digit', hour12: true });
        document.getElementById('sunset').textContent = sunset.toLocaleTimeString('en-AU', { hour: '2-digit', minute: '2-digit', hour12: true });
        
        const daylightHours = (sunset - sunrise) / (1000 * 60 * 60);
        document.getElementById('daylight').textContent = `${Math.floor(daylightHours)}h ${Math.round((daylightHours % 1) * 60)}m`;
      }
      
      lucide.createIcons();
    }

    // Load weather on page load
    fetchWeather();
    
    // Refresh weather every 10 minutes
    setInterval(fetchWeather, 600000);
  </script>
</body>
</html>
